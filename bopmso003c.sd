%%
/*
Date Written: April 24, 2002

Name: bopmso003c.sd

Copyright (c) 2000, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
05/17/2010           REL/JLB              new dec with sfsprinter info NWIC only
---------------------------------------------------------------------------
*/

Program
  Name = "bopmso003c";
  Type = "File";
  Domain = "SFPPRINT1";
  Padcharacter = Space;

 String L_FILE_NAME[13] = "bopmso003c.cq";
 String L_COPY_NAME[20] ;
 String I_REV_NAME2[50] ;
 String L_POLICY_FORM;
 String L_TYPE_STR[100];
 String L_POLICY_DECLARATION[60];
 String L_TRANS_EFF;
 String L_AUDIT;
 String L_PREV_STRING[100];
 String L_INSURED_CITY_STATE[50];
 String L_SFPNAME_ZIP="";
 String L_SFSAGENT;
 String L_SFPLOCATION_ZIP;
 String L_SFSMORT_ZIP[10];
 String L_SFPSUPP_ZIP[10];
 String L_AGENT_ADDRESS;
 String L_FOB[75];
 string l_font[35] ;
 String L_AGENT_TEL[13];
 String L_AGENT_ZIP[10];
 String L_MORGAGE_ID[10];
 String L_LOB_CODE[10];
 String L_STATE;
 String L_COMPANY_ZIP[10];
 String L_TERROR_FORM[7];
 String L_COMPANY_ID[10];
 String L_BILL_PLAN[2];
 String L_MORTGAGE_TYPE_1[1];
 String L_STATE_STR[2];
 String L_PRINT_BLANK_WORDING;
 String L_MORTGAGE_TYPE_2[1];
 String L_SIGNATURE_STRING[55];
 String l_str_prev_policy_no[9];
 String l_alpha_previous_policy[5];
 String L_PRINTER[4];
 String L_USER_ID[15];


 Number L_TRANS_CODE;
 Number L_MM_1;
 Number L_DD_1;
 Number L_YY_1;
 Number L_RENEWAL[9];

 Unsigned Ascii Number L_DECIPOINT,
                       l_total_boilers_premium;
 Unsigned Ascii Number L_CHARACTER_PER_INCH;
 Unsigned Ascii Number L_LEN_STRING;
 Unsigned Ascii Number l_year[4] ;
 Unsigned Ascii Number l_end_sequence[4] ;
 Unsigned Ascii Number L_PAGE_MIDDLE;
 Unsigned Ascii Number L_HALF_MULTIPLIER;
 Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
 Unsigned Ascii Number L_PAGE_NUMBER = 1;
 Unsigned Ascii Number L_ITEM_COUNTER;
 Unsigned Ascii Number L_LINE_COUNTER;
 Unsigned Ascii Number L_MED_LIMIT;
 Unsigned Ascii Number L_S_LINE_FOR_LOCATION = 0; --start line for location
 Unsigned Ascii Number L_BIGGER_LINE =0;
 Unsigned Ascii Number L_SCREEN_COR= 0;
 Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
 Unsigned Ascii Number L_PAGENUMBER;
 Unsigned Ascii Number L_MAX_LINES;
 Unsigned Ascii Number L_LOCATION_COUNTER;
 Unsigned Ascii Number L_SIZE_COUNTER;
 Unsigned Ascii Number L_LIABILITY;
 Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
 Unsigned Ascii Number L_INSURED_COUNTER;
 Unsigned Ascii Number L_AGENT_COUNTER;
 Unsigned Ascii Number L_TWO_PLACER;
 unsigned ascii number l_sfpamt_lob[4] ;
 Unsigned Ascii Number L_SFSFORM[2];
 Unsigned Ascii Number L_SFPMASTER_FORM[1];
 Unsigned Ascii Number L_LOOP;
 Unsigned Ascii Number L_SCIPSCONTROL;
 Unsigned Ascii Number L_STATE_NUM[2];
 Unsigned Ascii Number L_PRINTED_DATED[1];  --delete after scipscontrol is set up
 Unsigned Ascii Number L_LOC_COUNTER;
 Unsigned Ascii Number L_PRINTER_NO[4];
 string l_enter[1];

 Include "swsut100.var"
 Include "csfonts.inc"
 Include "sfsrevname.var"
 Include "header.var"

Initialization
Deletefile (L_FILE_NAME);

L_PRINTER = COMMANDLINE[1,4]
L_COPY_NAME = Uppercase(COMMANDLINE[6,25])


Update

Access SFPNAME,
   Set SFPNAME:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPNAME:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPNAME:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Access BOPOPERATIONS,
   Set BOPOPERATIONS:POLICY_NO    = SFPPRINT1:POLICY_NO,
       BOPOPERATIONS:POL_YEAR     = SFPPRINT1:POL_YEAR,
       BOPOPERATIONS:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,Generic;

Access BOPGENERAL ,
   Set BOPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
       BOPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
       BOPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

access sfpamt, set sfpamt:policy_no    = sfpprint1:policy_no,
       sfpamt:pol_year     = sfpprint1:pol_year,
       sfpamt:end_sequence = sfpprint1:end_sequence, generic

l_line_of_business = sfpamt:line_of_business[5]

if l_line_of_business = 0 then
   l_line_of_business = sfpname:line_of_business

access sfpmastsupp, set sfpmastsupp:policy_no        = sfpprint1:policy_no,
       sfpmastsupp:pol_year         = sfpprint1:pol_year,
       sfpmastsupp:end_sequence     = sfpprint1:end_sequence,
       sfpmastsupp:line_of_business = l_line_of_business, generic

Access SFPMASTER,
   Set SFPMASTER:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPMASTER:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPMASTER:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Access SFPEND,
   Set SFPEND:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPEND:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPEND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Access SFPPRINT3,
   Set SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic ;

Access SFSCOMPANY,
   Set SFSCOMPANY:COMPANY_ID = SFPNAME:COMPANY_ID, Exact;

Access SFPCURRENT,
   Set SFPCURRENT:POLICY_NO = SFPPRINT1:POLICY_NO, Exact;

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = SFPNAME:COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
       sfsline:lob_subline      = "00", Generic;

Access SFSLINE_alias,
   Set SFSLINE_alias:COMPANY_ID       = SFPNAME:COMPANY_ID,
       SFSLINE_alias:LINE_OF_BUSINESS = sfpname:LINE_OF_BUSINESS,
       sfsline_alias:lob_subline      = "00", Generic;

Access SFSAGENT,
   Set SFSAGENT:COMPANY_ID = SFPNAME:COMPANY_ID,
       SFSAGENT:AGENT_NO   =  SFPNAME:AGENT_NO, Exact;

Access SFSSTATE,
   Set SFSSTATE:COMPANY_ID = BOPGENERAL:COMPANY_ID,
       SFSSTATE:STATE      = BOPGENERAL:STATE,
       SFSSTATE:COUNTY     = BOPGENERAL:COUNTY, Exact;

Access SFSCONSTRUCTION,
   Set SFSCONSTRUCTION:COMPANY_ID       = BOPGENERAL:COMPANY_ID,
       SFSCONSTRUCTION:STATE            = BOPGENERAL:STATE,
       SFSCONSTRUCTION:LINE_OF_BUSINESS = BOPGENERAL:LINE_OF_BUSINESS,
       SFSCONSTRUCTION:CONSTRUCTION     = BOPGENERAL:CONSTRUCTION, Exact;

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

access wcsdefault,
   set wcsdefault:company_id = sfpname:company_id, generic

Access wcpgeneral,
   Set wcpgeneral:POLICY_NO    = SFPPRINT1:POLICY_NO,
       wcpgeneral:POL_YEAR     = SFPPRINT1:POL_YEAR,
       wcpgeneral:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic ;

if sfpmastsupp:policy_no <> 0 then
    L_SFSFORM = SFPMASTSUPP:FORM
else
    l_sfsform = sfpmaster:form

Access SFSFORM,
   Set SFSFORM:COMPANY_ID       = BOPGENERAL:COMPANY_ID,
       SFSFORM:STATE            = BOPGENERAL:STATE,
       SFSFORM:LINE_OF_BUSINESS = BOPGENERAL:LINE_OF_BUSINESS,
       SFSFORM:POLICY_FORM      = L_SFSFORM, Exact


if sfsline_alias:lob_code one of "CPORTFOLIO" then
  begin
    if sfpname:str_prev_policy_no <> "" and
       scipscontrol:wc_print_zeros_policy_no = 1 then
      {
        l_str_prev_policy_no = sfpname:str_prev_policy_no
      }

L_PREV_STRING = If SFPNAME:STR_PREV_POLICY_NO not one of "", "000000000" and
                   scipscontrol:wc_print_zeros_policy_no = 1 Then

                    sfpname:str_prev_policy_no
                else
                  if sfpname:previous_policy_no not one of 0 and
                     scipscontrol:wc_print_zeros_policy_no = 0 then

                     str(sfpname:previous_policy_no)
                Else
                    Str(SFPNAME:policy_no)

switch(sfpname:line_of_business)
  case 99 : l_alpha_previous_policy = wcsdefault:alpha_previous_policy[2]
  default : l_alpha_previous_policy = wcsdefault:alpha_previous_policy[1]
  end

if bopgeneral:state = 37 and
   sfpname:previous_policy_no <> 0 and
   sfpname:eff_date < 08.31.2009 then
    begin
    if l_alpha_previous_policy <> "" then
        begin
        switch(l_alpha_previous_policy)
          case "LMP" : switch(wcsdefault:no_zeros_in_policy_no)
                         case 1  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "00" + sfpname:str_prev_policy_no
                                   end
                         case 2  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "000" + sfpname:str_prev_policy_no
                                   end
                         default : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + sfpname:str_prev_policy_no
                                   end
                         end
          default    : switch(wcsdefault:no_zeros_in_policy_no)
                         case 1  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "0" + sfpname:str_prev_policy_no
                                   end
                         case 2  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "00" + sfpname:str_prev_policy_no
                                   end
                         default : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + sfpname:str_prev_policy_no
                                   end
                         end
          end
        end
    else
        begin
        l_prev_string = str(sfpname:previous_policy_no)
        end
    end
end
else
    begin
    l_end_sequence = 0
    l_year = sfpprint1:pol_year - 1
    access sfpname_alt, set sfpname_alt:policy_no = sfpprint1:policy_no,
                            sfpname_alt:pol_year = l_year,
                            sfpname_alt:end_sequence = l_end_sequence, generic

    if sfpname_alt:policy_no = sfpprint1:policy_no and
       sfpname_alt:pol_year = l_year and
       sfpname_alt:end_sequence = l_end_sequence then
        begin
        L_PREV_STRING = Str(SFPNAME:POLICY_NO)
        end
    else
        begin
        L_PREV_STRING = If (SFPNAME:PREVIOUS_POLICY_NO <> 0) Then
                            Str(SFPNAME:PREVIOUS_POLICY_NO)
                        Else
                            Str(SFPNAME:POLICY_NO)
        end
    end

L_POLICY_DECLARATION = Trun(SFSLINE:DESCRIPTION) + " " + "POLICY DECLARATIONS"

L_AGENT_TEL = SFSAGENT:TELEPHONE[1];

L_SFSAGENT = If (Val(SFSAGENT:ZIPCODE_1_4) = 0) Then
                      SFSAGENT:ZIPCODE_5_9
             Else
                      SFSAGENT:ZIPCODE_5_9 + "-" + SFSAGENT:ZIPCODE_1_4

L_SFPNAME_ZIP = If (Val(SFPNAME:STR_ZIPCODE[6,9]) = 0) Then
                        SFPNAME:STR_ZIPCODE[1,5]
                Else
                        SFPNAME:STR_ZIPCODE[1,5] + "-" +
                        SFPNAME:STR_ZIPCODE[6,9]

L_INSURED_CITY_STATE = Trun(SFPNAME:CITY) + ", " + SFPNAME:STR_STATE + "  " + L_SFPNAME_ZIP

L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                  SFSAGENT:STR_ZIPCODE[1,5]
               Else
                  SFSAGENT:STR_ZIPCODE[1,5] + "-" +
                  SFSAGENT:STR_ZIPCODE[6,9]

L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                       SFSCOMPANY:STR_ZIPCODE[1,5]
                 Else
                       SFSCOMPANY:STR_ZIPCODE[1,5] + "-" +
                       SFSCOMPANY:STR_ZIPCODE[6,9]

L_COMPANY_ID = SFPNAME:COMPANY_ID

L_AGENT_ADDRESS = SFSAGENT:CITY + ", " + SFSAGENT:STR_STATE

if sfpmastsupp:policy_no <> 0 then
    L_MED_LIMIT = SFPMASTSUPP:MEDICAL_LIMIT
else
    l_med_limit = sfpmaster:medical_limit

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  case 'L' : L_FOB = "LLC"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

L_TRANS_CODE = SFPMASTER:TRANS_CODE
L_MM_1       = Month(SFPMASTER:TRANS_EFF)
L_DD_1       = Day(SFPMASTER:TRANS_EFF)
L_YY_1       = Year(SFPMASTER:TRANS_EFF)
L_AUDIT      = SFPMASTER:AUDIT

L_TRANS_EFF = Str(L_MM_1) + "/" + Str(L_DD_1) + "/" + Str(L_YY_1)
Include "swudeccs.inc"

if sfpmastsupp:policy_no <> 0 then
  begin
    Switch(SFPMASTSUPP:LIABILITY_CODE)
      Case 1 : L_LIABILITY = 300000
      Case 2 : L_LIABILITY = 500000
      Case 3 : L_LIABILITY = 1000000
      End
  end
else
  begin
    Switch(SFPMASTER:LIABILITY_CODE)
      Case 1 : L_LIABILITY = 300000
      Case 2 : L_LIABILITY = 500000
      Case 3 : L_LIABILITY = 1000000
      End
  end

L_MAX_LINES        = 60
L_SIZE_COUNTER     = 0
L_LINE_COUNTER     = 1
L_PAGENUMBER       = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER  = 0
L_AGENT_COUNTER    = 0
L_LOB_CODE         = SFSLINE:LOB_CODE

Include "swsut100.inc"

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID          = L_COMPANY_ID,
       SCIPSCONTROL:STATE               = I_STATE,
       SCIPSCONTROL:LOB_CODE            = L_LOB_CODE, Exact

L_USER_ID = USERNAME  -- getting current user name
L_PRINTER_NO = Val(L_PRINTER)   --converting l_printer to the number

--Writefile(L_FILE_NAME,"%s","jamieb")

  Access SFSPRINTER,
     Set SFSPRINTER:COMPANY_ID = L_COMPANY_ID,
         SFSPRINTER:USER_ID    = L_USER_ID,
         SFSPRINTER:PRINTER_NO = L_PRINTER_NO, Exact


If uppercase(L_COPY_NAME) one of "ORIGINAL" and
   sfpname:line_of_business not one of 99 then
  {
    Writefile(L_FILE_NAME,"%s%n%s","<033>&l",SFSPRINTER:TRAY2[1],"H")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%n%s","<033>&l",SFSPRINTER:TRAY2[2],"H")
  }


If SCIPSCONTROL:DUPLEX_SHORT_EDGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s",L_SEDUP)
  }
Else
  {
    Writefile(L_FILE_NAME,"%s",L_LEDUP)
  }

--border
If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
  }

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a400h7250V")

If Uppercase(L_COPY_NAME) = "HOME OFFICE" And
   sfpname:REINSURANCE = "Y" And
   SCIPSCONTROL:FAC_REINSURANCE_ON_DEC = 1 Then
  {
    Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:FAC_REINSURANCE_WORD_ON_DEC))
  }

Writefile(L_FILE_NAME,"%s","<033>&a2400h+0V")
Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
do check_payor_flags  --this will put payor codes on the bottom of the dec
Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

Include "header.inc"

Writefile(L_FILE_NAME,"%s","<033>&a300h+60V")
Writefile(L_FILE_NAME,"%s","<033>&f0S") --pushed memory location on stack
L_LINE_COUNTER = L_LINE_COUNTER + 1

If SCIPSCONTROL:BOP_FORMS_CHECK_BOX = 1 Then  --checks to see if basic check box will be printed on dec page
                                              --this is the number of forms box that will print on the dec 3 if checked
  {
    If l_sfsform = 1 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL_BOLD,"<033>&a2310h-2V","X")
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_12,
                          "<033>&a2300h-85V<033>*c85h10v0P",  -- top horizontal
                          "<033>&a2300h+0V<033>*c5a40b0P", -- left vertical
                          "<033>&a2380h+0V<033>*c5a40b0P", -- right vertical
                          "<033>&a2300h+85V<033>*c85h10v0P", -- bottom horizontal
                          L_ARIAL_BOLD_12,"<033>&a2500h+0V","BASIC","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_12,"<033>&a300h+30V",
                      "<033>&a2300h-85V<033>*c85h10v0P",  -- top horizontal
                      "<033>&a2300h+0V<033>*c5a40b0P", -- left vertical
                      "<033>&a2380h+0V<033>*c5a40b0P", -- right vertical
                      "<033>&a2300h+85V<033>*c85h10v0P", -- bottom horizontal
                      L_ARIAL_BOLD_12,"<033>&a2500h+0V","BASIC PLUS")

    If l_sfsform = 2 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL_BOLD,"<033>&a2310h-2V","X")
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>","<033>&a300h+30V",
                      L_ARIAL_12,"<033>&a2300h-85V<033>*c85h10v0P",  -- top horizontal
                      "<033>&a2300h+0V<033>*c5a40b0P", -- left vertical
                      "<033>&a2380h+0V<033>*c5a40b0P", -- right vertical
                      "<033>&a2300h+85V<033>*c85h10v0P", -- bottom horizontal
                      L_ARIAL_BOLD_12,"<033>&a2500h-0V","EXPANDED")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    If l_sfsform = 3 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a2310h-2V","X")
      }

  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_12,"<033>&a300h+30V",
                      "<033>&a2300h-85V<033>*c85h10v0P",  -- top horizontal
                      "<033>&a2300h+0V<033>*c5a40b0P", -- left vertical
                      "<033>&a2380h+0V<033>*c5a40b0P", -- right vertical
                      "<033>&a2300h+85V<033>*c85h10v0P", -- bottom horizontal
                      L_ARIAL_BOLD_12,"<033>&a2500h+0V","BASIC PLUS")

    If l_sfsform = 1 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL_BOLD,"<033>&a2310h-2V","X")
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>","<033>&a300h+30V",
                      L_ARIAL_12,"<033>&a2300h-85V<033>*c85h10v0P",  -- top horizontal
                      "<033>&a2300h+0V<033>*c5a40b0P", -- left vertical
                      "<033>&a2380h+0V<033>*c5a40b0P", -- right vertical
                      "<033>&a2300h+85V<033>*c85h10v0P", -- bottom horizontal
                      L_ARIAL_BOLD_12,"<033>&a2500h-0V","EXPANDED")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    If l_sfsform = 3 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a2310h-2V","X")
      }

  }

Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&f1S",L_ARIAL_12,"<033>&a300h+30V",
                      "Policy Number","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD_14,
                      "<033>&a300h+20V",Trun(SFSLINE:ALPHA),
                      trun(str(SFPPRINT1:POLICY_NO)))

if scipscontrol:payor_code_bottom_of_page not one of 1 then   --put it on the top of dec by policy number
  {
    If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
      {
        If SCIPSCONTROL:PAYOR_CODES = 1 and
           trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
          {
            do print_payor_codes
          }
      }
    Else
      If SCIPSCONTROL:PAYOR_CODES = 1 Then
        {
          do print_payor_codes
        }
  }

If (SFPNAME:POLICY_TYPE = "W") and
   l_trans_code one of 10, 14 Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD_12,"<033>&a300h+120V",
                          "Rewrite of ",L_PREV_STRING)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s","<NL>",L_ARIAL_BOLD_12,
                           "<033>&a300h+120V",L_TYPE_STR)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }


If (L_TRANS_CODE One Of 12,13) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%n",L_ARIAL_BOLD_12,"<033>&a3900h+0V",
    "Endorsement #",SFPNAME:ENDORSEMENT_NUMBER)
  }



Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",L_ARIAL_BOLD,
                      "<033>&a200h+0V","1.","<033>&a350h+0V","Named Insured and Mailing Address",
                      "<033>&a3000h+0V","Agent -","<033>&a3400h+0V",SFSAGENT:AGENT_NO,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

writefile(L_FILE_NAME,"%s","<033>&f0S")   --push the cursor position on the stack
Writefile(L_FILE_NAME,"%s","<033>&f0S")   --used to see if agent or insured
                                          --name/address has more lines

Writefile(L_FILE_NAME,"%s",L_ARIAL_8)

For L_LOOP = 1 To 3
  {
    I_NAME=sfpNAME:NAME[L_LOOP]
    Include "sfsrevname7.pro"
    If sfpNAME:NAME[L_LOOP] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",I_REV_NAME,"<NL>")
        L_INSURED_COUNTER = L_INSURED_COUNTER +1
      }
  }
For L_LOOP = 1 To 3
  {
    If (sfpNAME:ADDRESS[L_LOOP] <> "") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",sfpNAME:ADDRESS[L_LOOP],"<NL>")
        L_INSURED_COUNTER = L_INSURED_COUNTER +1
      }
  }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1

--START OF AGENT pRINTING
Writefile(L_FILE_NAME,"%s","<033>&f1S")  --pop agent cursor postion off stack

For L_LOOP = 1 To 3
  {
    If SFSAGENT:NAME[L_LOOP] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[L_LOOP],"<NL>")
        l_agent_counter = l_agent_counter + 1
      }
  }
For L_LOOP = 1 To 3
  {
    If SFSAGENT:ADDRESS[L_LOOP] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[L_LOOP],"<NL>")
        l_agent_counter = l_agent_counter + 1
      }
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
l_agent_counter = l_agent_counter + 1
Writefile(L_FILE_NAME,"%s%s%s%s %s-%s","<033>&a3000h+0V",
                    "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6], L_AGENT_TEL[7,10])

Writefile(L_FILE_NAME,"%s",l_pop)  --pop agent cursor postion off stack
If l_agent_counter > l_insured_counter Then
  {
    For l_loop = 1 to l_agent_counter
      {
        Writefile(L_FILE_NAME,"%s","<NL>")
      }
    l_line_counter = l_line_counter + l_agent_counter
  }
Else
  {
    For l_loop = 1 to l_insured_counter
      {
        Writefile(L_FILE_NAME,"%s","<NL>")
      }
    l_line_counter = l_line_counter + l_insured_counter
  }

Writefile(L_FILE_NAME,"%s%s%s","<033>&a140h+20V","<033>*c5455h20v0P","<NL>") --under name horizontal line to
l_line_counter = l_line_counter + 1


Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s%s",
                      L_ARIAL_BOLD,"<033>&a200h+0V",
                      "2.","<033>&a350h+0V","Policy Term: ",L_ARIAL,"12:01 A.M.  Standard Time From ",
                      Str(SFPNAME:EFF_DATE,"mm/dd/yyyy")," to ",
                      Str(SFPNAME:EXP_DATE,"mm/dd/yyyy"),"<NL>","<NL>")
l_line_counter = l_line_counter +2

Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h+0V","3.",
                      "<033>&a350h+0V","You are a:  ",
                      L_ARIAL,Uppercase(L_FOB),"<NL>","<NL>")
l_line_counter = l_line_counter + 2

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,generic

L_LOC_COUNTER = 0

While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
  {
    L_LOC_COUNTER = L_LOC_COUNTER + 1
    Next SFPLOCATION
  }

Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h+0V","4.",
          "<033>&a350h+0V","Your Business/Operation:  ",L_ARIAL)

If L_LOC_COUNTER >= 4 Then
  {
    Writefile(L_FILE_NAME,"%s","See supplemental for business description")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a1650h+0V")
    Writefile(L_FILE_NAME,"%s",BOPGENERAL:BUSINESS_DESC[1])

    If BOPGENERAL:BUSINESS_DESC[2] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s","<NL>")
        Writefile(L_FILE_NAME,"%s","<033>&a1650h+0V")
        Writefile(L_FILE_NAME,"%s",BOPGENERAL:BUSINESS_DESC[2])
        l_line_counter = l_line_counter + 1
      }
  }

Writefile(L_FILE_NAME,"%s%s","<NL>","<NL>")
l_line_counter = l_line_counter + 2

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,
       SFPLOCATION:PREM_NO      = BOPGENERAL:PREM_NO,
       SFPLOCATION:BUILD_NO     = BOPGENERAL:BUILD_NO, Generic;


Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a350h+0V",
                      "IN RETURN FOR THE PAYMENT OF PREMIUM, AND SUBJECT TO ",
                      "ALL THE TERMS OF THIS POLICY, WE","<NL>")
l_line_counter = l_line_counter + 1

Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a350h+0V",
                      "AGREE WITH YOU TO PROVIDE THE INSURANCE AS STATED IN ",
                      "THIS POLICY. THERE ARE EXCLUSIONS,","<NL>")
l_line_counter = l_line_counter + 1

Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a350h+0V",
                      "CONDITIONS AND LIMITATIONS CONTAINED IN THE POLICY ",
                      "FORMS AND ENDORSEMENTS.","<NL>")
l_line_counter = l_line_counter + 1
Writefile(L_FILE_NAME,"%s%s","<033>&a140h-60V<033>*c5455h20v0P","<NL>") --under name horizontal line to
l_line_counter = l_line_counter + 1

Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h+0V","5.",
                      "<033>&a2200h+0V","SCHEDULE OF PREMISES","<NL>")
l_line_counter = l_line_counter + 1

L_S_LINE_FOR_LOCATION = l_line_counter + 2

While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
  {
    Access BOPGENERAL ,
       Set BOPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
           BOPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
           BOPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,
           BOPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
           BOPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Exact

    Access SFSSTATE,
       Set SFSSTATE:COMPANY_ID = BOPGENERAL:COMPANY_ID,
           SFSSTATE:STATE      = BOPGENERAL:STATE,
           SFSSTATE:COUNTY     = BOPGENERAL:COUNTY, Exact

    Access SFSCONSTRUCTION,
       Set SFSCONSTRUCTION:COMPANY_ID       = BOPGENERAL:COMPANY_ID,
           SFSCONSTRUCTION:STATE            = BOPGENERAL:STATE,
           SFSCONSTRUCTION:LINE_OF_BUSINESS = BOPGENERAL:LINE_OF_BUSINESS,
           SFSCONSTRUCTION:CONSTRUCTION     = BOPGENERAL:CONSTRUCTION, Exact

    --checking to see if the address field are blank in they are not blank then we need
    --to adjust the counter to the appropriate line to make sure that the next group
    --of data that prints will print all together.

    If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
      {
        L_SFPLOCATION_ZIP = SFPLOCATION:STR_ZIPCODE[1,5]
      }
    Else
      {
        L_SFPLOCATION_ZIP = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                            SFPLOCATION:STR_ZIPCODE[6,9]
      }

    If SFPLOCATION:ADDRESS1[1] <> "" And
       SFPLOCATION:ADDRESS1[2] <> "" And
       SFPLOCATION:ADDRESS1[3] <> "" Then
      {
        L_SIZE_COUNTER = 16
      }
    Else
      If SFPLOCATION:ADDRESS1[1] <> "" And
         SFPLOCATION:ADDRESS1[2] <> "" Then
        {
          L_SIZE_COUNTER = 15
        }
    Else
      If SFPLOCATION:ADDRESS1[1] <> "" Then
        {
          L_SIZE_COUNTER = 14
        }
    Else
      {
        L_SIZE_COUNTER = 13
      }
    If l_line_counter >= L_MAX_LINES - L_SIZE_COUNTER And
       L_LOCATION_COUNTER >= 2 Then
      {

        If L_PAGE_NUMBER = 1 Then
          {
             Writefile(L_FILE_NAME,"%s%s%n%s%s",L_ARIAL_ITALIC,
                       "<033>&a2165h",L_S_LINE_FOR_LOCATION*120-80,"V",
                       "additional locations applicable")
          }
        L_PAGE_NUMBER = L_PAGE_NUMBER +1

        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                              "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                              "Page ",L_PAGE_NUMBER)
        --border
        If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
          {
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
            Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
            Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
          }
        Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
        Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a2000h+0V",
                              "SCHEDULE OF PREMISES CONTINUED","<NL>")
                              l_line_counter = 2
        Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
      }

    If L_LOCATION_COUNTER < 2 Then
      {      --added additional <NL> here
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+0V<033>*c5455h20v0P","<NL>","<NL>")
        --line above location , only prints once
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s%s",L_ARIAL,
                          "<033>&a200h+0V","Location","<033>&a700h+0V",
                          SFPLOCATION:PREM_NO,"<033>&a1000h+0V","Building",
                          "<033>&a1500h+0V",SFPLOCATION:BUILD_NO,"<033>&a2500h+0V","County")
    If (SFSCOMPANY:PRINT_INFO_ON_BOP_DEC = 1) Then
      {
        Writefile(L_FILE_NAME,"%s%s%S%S%S%S%S","<033>&a3400h+0V","Construction",
                              "<033>&a4100h+0V","Occupancy","<033>&a4700h+0V",
                              "Rating Class","<NL>")
        l_line_counter = l_line_counter + 1
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<NL>")
        l_line_counter = l_line_counter + 1
      }

    Writefile(L_FILE_NAME,"%s%s","<033>&a2500h+0V",SFSSTATE:DESCRIPTION)
    If (SFSCOMPANY:PRINT_INFO_ON_BOP_DEC = 1) Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%n%s%s%s%s%s%s%n","<033>&a3650h+0V",
                              SFSCONSTRUCTION:CODE,"<033>&a4300h+0V",
                              BOPGENERAL:CLASS_CODE,"<033>&a4700h+0V","Basic: (",
                              Str(BOPGENERAL:RATE_NO),")",
                              "<033>&a5170h+0V"," Exp: ",BOPGENERAL:RATE_GROUP)
      }
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+0V",SFPLOCATION:ADDRESS,"<NL>")
    l_line_counter = l_line_counter + 1

    If (SFPLOCATION:ADDRESS1[1] <> "") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+0V",SFPLOCATION:ADDRESS1[1],"<NL>")
        l_line_counter = l_line_counter + 1
      }
    If (SFPLOCATION:ADDRESS1[2] <> "") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+0V",SFPLOCATION:ADDRESS1[2],"<NL>")
        l_line_counter = l_line_counter + 1
      }
    If (SFPLOCATION:ADDRESS1[3] <> "") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+0V",SFPLOCATION:ADDRESS1[3],"<NL>")
        l_line_counter = l_line_counter + 1
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a200h+0V",Trun(SFPLOCATION:CITY),", ",
                          Trun(SFPLOCATION:STR_STATE)," ",L_SFPLOCATION_ZIP,"<NL>")
    l_line_counter = l_line_counter + 1

    If (L_LOCATION_COUNTER = 1) Then
      {
        Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h5v0P","<NL>")
        l_line_counter = l_line_counter + 1

        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a1000h+0V",
                              "PART I - BUSINESS   PROPERTY   AND   LOSS   OF   ",
                              "BUSINESS   INCOME","<NL>")
        l_line_counter = l_line_counter + 1

        Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h5v0P","<NL>")
        l_line_counter = l_line_counter + 1

        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,"<033>&a1000h-0V",
                              "LIMIT OF LIABILITY","<033>&a3500h+0V",
                              "COVERAGES","<NL>")
        l_line_counter = l_line_counter + 1
      }
    Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h5v0P","<NL>")

    if sfpmastsupp:policy_no <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s%s%n%s%s%s",L_ARIAL_BOLD,
                              "<033>&a500h+0V","Location",
                              "<033>&a1000h+0V",BOPGENERAL:PREM_NO,"<033>&a1500h+0V",
                              "Building","<033>&a2000h+0V",BOPGENERAL:BUILD_NO,
                               "<033>&a3000h+0V","$",SFPMASTSUPP:DEDUCTIBLE,
                              "<033>&a3410h+0V","< Deductible - Coverages A and B","<NL>")
      end
    else
      begin
        Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s%s%n%s%s%s",L_ARIAL_BOLD,
                              "<033>&a500h+0V","Location",
                              "<033>&a1000h+0V",BOPGENERAL:PREM_NO,"<033>&a1500h+0V",
                              "Building","<033>&a2000h+0V",BOPGENERAL:BUILD_NO,
                               "<033>&a3000h+0V","$",SFPMASTER:DEDUCTIBLE,
                              "<033>&a3410h+0V","< Deductible - Coverages A and B","<NL>")
      end
    l_line_counter = l_line_counter + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h5v0P","<NL>")

    If BOPGENERAL:LIABILITY_ONLY = 1 then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s%s","<033>&a500h+0V","Not Applicable")
      }
    Else
    If BOPGENERAL:BUILDING_LIMIT = 0 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,"<033>&a800h+0V",
                          SCIPSCONTROL:BLANK_WORDING)
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,
                          Str(BOPGENERAL:BUILDING_LIMIT,"ZZ,ZZZ,ZZZ"))
        If Uppercase(BOPGENERAL:ACV_BUILDING) = "Y" Then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_8,"<033>&a1500h+0V",
                                   "Actual Cash Value",
                                   "<033>&a2200h-85V<033>*c85h10v0P",  -- top horizontal
                                   "<033>&a2200h+0V<033>*c5a40b0P", -- left vertical
                                   "<033>&a2280h+0V<033>*c5a40b0P", -- right vertical
                                   "<033>&a2200h+85V<033>*c85h10v0P", -- bottom horizontal
                                    L_ARIAL_BOLD,"<033>&a2210h-0V","X")
          }
        else
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_8,"<033>&a1500h+0V",
                                  "Replacement Cost",
                                  "<033>&a2200h-85V<033>*c85h10v0P",  -- top horizontal
                                  "<033>&a2200h+0V<033>*c5a40b0P", -- left vertical
                                  "<033>&a2280h+0V<033>*c5a40b0P", -- right vertical
                                  "<033>&a2200h+85V<033>*c85h10v0P", -- bottom horizontal
                                  L_ARIAL_BOLD,"<033>&a2210h-0V","X")
          }
      }

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s%s","<033>&a2800h-0V","A. Building*")
    Writefile(L_FILE_NAME,"%s","<033>&a4350h-0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_bold_9)
    Writefile(L_FILE_NAME,"%s","Annual Inflation Guard")
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    Writefile(L_FILE_NAME,"%s",Str(BOPGENERAL:auto_percent,"ZZZ"))
    Writefile(L_FILE_NAME,"%s","%")
    Writefile(L_FILE_NAME,"%s","<NL>")
    l_line_counter = l_line_counter + 1

    If sfpname:company_id one of "NWIC" then
      {
        If bopgeneral:other_structures <> 0 then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                               L_LETTER_GOTHIC_BOLD_10,
                              Str(BOPGENERAL:other_structures,"ZZ,ZZZ,ZZZ"))

            Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_9,"<033>&a2800h+0V",
                              "Other Structures","<NL>")
          }
      }


    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    If BOPGENERAL:LIABILITY_ONLY = 1 then
      {
        Writefile(L_FILE_NAME,"%s%s","<033>&a500h+0V","Not Applicable")
      }
    Else
    If (BOPGENERAL:PROPERTY_LIMIT = 0) Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,"<033>&a800h+0V",
                          SCIPSCONTROL:BLANK_WORDING)
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,
                          Str(BOPGENERAL:PROPERTY_LIMIT,"ZZ,ZZZ,ZZZ"))
        If Uppercase(BOPGENERAL:ACV_CONTENTS) = "Y" Then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_8,"<033>&a1500h+0V",
                                  "Actual Cash Value",
                                  "<033>&a2200h-85V<033>*c85h10v0P",  -- top horizontal
                                  "<033>&a2200h+0V<033>*c5a40b0P", -- left vertical
                                  "<033>&a2280h+0V<033>*c5a40b0P", -- right vertical
                                  "<033>&a2200h+85V<033>*c85h10v0P", -- bottom horizontal
                                  L_ARIAL_BOLD,"<033>&a2210h-0V","X")
          }
        else
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_8,"<033>&a1500h+0V",
                                  "Replacement Cost",
                                  "<033>&a2200h-85V<033>*c85h10v0P",  -- top horizontal
                                  "<033>&a2200h+0V<033>*c5a40b0P", -- left vertical
                                  "<033>&a2280h+0V<033>*c5a40b0P", -- right vertical
                                  "<033>&a2200h+85V<033>*c85h10v0P", -- bottom horizontal
                                  L_ARIAL_BOLD,"<033>&a2210h-0V","X")
          }
      }

    Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_9,"<033>&a2800h+0V",
                          "B. Business Personal Property","<NL>")
    l_line_counter = l_line_counter + 1

    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)

    if sfscompany:company_id not one of "NWIC" then
      {
        If BOPGENERAL:LIABILITY_ONLY = 1 then
          {
            Writefile(L_FILE_NAME,"%s%s","<033>&a500h+0V","Not Applicable")
          }
        Else
        If (BOPGENERAL:DELETE_LOSS_INCOME = "Y") Then
          {
            Writefile(L_FILE_NAME,"%s%s","<033>&a800h-0V",SCIPSCONTROL:BLANK_WORDING)
          }
        Else
          If (BOPGENERAL:LOSS_INCOME_LIMIT = 0) Then
            {
              Writefile(L_FILE_NAME,"%s%s","<033>&a640h-0V","Included")
            }
          Else
            {
              Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(BOPGENERAL:LOSS_INCOME_LIMIT,"ZZ,ZZZ,ZZZ"))
            }
      }
    else
      {
        If BOPGENERAL:LIABILITY_ONLY = 1 then
          {
            Writefile(L_FILE_NAME,"%s%s","<033>&a500h+0V","Not Applicable")
          }
        Else
          If (BOPGENERAL:DELETE_LOSS_INCOME = "Y") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",L_LETTER_GOTHIC_BOLD_10)
              Writefile(L_FILE_NAME,"%s%s","<033>&a800h-0V",SCIPSCONTROL:BLANK_WORDING)
            }
          Else
            If (BOPGENERAL:LOSS_INCOME_LIMIT = 0) Then
              {
                Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                                L_LETTER_GOTHIC_BOLD_10,
                                Str(BOPGENERAL:LOSS_INCOME_LIMIT,"ZZ,ZZZ,ZZ9"))
                                                              --    "<033>&a500h+0V"
                 --Writefile(L_FILE_NAME,"%s%s","<033>&a640h-0V","Included")
              }
            Else
              {
                Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V","$",
                                L_LETTER_GOTHIC_BOLD_10,
                                Str(BOPGENERAL:LOSS_INCOME_LIMIT,"ZZ,ZZZ,ZZZ"))
              }
      }


    Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_9,"<033>&a2800h+0V",
                          "C. Loss of Business Income - Included Unless ",
                          "marked 'nil'","<NL>")
    l_line_counter = l_line_counter + 1

    If l_sfsform = 1 And (BOPGENERAL:BUILDING_LIMIT > 0 And
       BOPGENERAL:PROPERTY_LIMIT = 0) And
       SCIPSCONTROL:PRINT_MONEY_SECURITY_WORDING = 0 Then
      {
        Writefile(L_FILE_NAME,"%s%s","<NL>","<NL>")
        l_line_counter = l_line_counter + 2
      }
    Else
      {
        If BOPGENERAL:LIABILITY_ONLY = 1 then
          {
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s","<033>&a500h+0V")
            Writefile(L_FILE_NAME,"%s","Not Applicable")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
            Writefile(L_FILE_NAME,"%s","D. Money and Securities - On Premises - All Locations")
            Writefile(L_FILE_NAME,"%s","<NL>")
          }
        Else
        If (BOPGENERAL:MONEY_LIMIT_ON = 0) Then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,
                          "<033>&a500h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,"<033>&a800h+0V",
                          SCIPSCONTROL:BLANK_WORDING,L_ARIAL_9,
                          "<033>&a2800h+0V","D. Money and Securities - On ",
                          "Premises - All Locations","<NL>")
          }
        Else
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(BOPGENERAL:MONEY_LIMIT_ON,"ZZ,ZZZ,ZZZ"),L_ARIAL_9,
                          "<033>&a2800h+0V","D. Money and Securities - On ",
                          "Premises - All Locations","<NL>")
          }
        l_line_counter = l_line_counter + 1

        If BOPGENERAL:LIABILITY_ONLY = 1 then
          {
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s","<033>&a500h+0V")
            Writefile(L_FILE_NAME,"%s","Not Applicable")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a2915h+0V")
            Writefile(L_FILE_NAME,"%s","Money and Securities - Off Premises - All Locations")
          }
        Else
        If (BOPGENERAL:MONEY_LIMIT_OFF = 0) Then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,"<033>&a800h+0V",
                          SCIPSCONTROL:BLANK_WORDING,L_ARIAL_9,
                          "<033>&a2915h+0V","Money and Securities - Off Premises ",
                          "- All Locations")
          }
        Else
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a500h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(BOPGENERAL:MONEY_LIMIT_OFF,"ZZ,ZZZ,ZZZ"),L_ARIAL_9,
                          "<033>&a2915h+0V","Money and Securities - Off Premises ",
                          "- All Locations")
          }
         l_line_counter = l_line_counter + 1

      }
      Writefile(L_FILE_NAME,"%s%s","<033>&a150h+40V<033>*c5455h20v0P","<NL>")

      L_LOCATION_COUNTER = L_LOCATION_COUNTER +1

    Next SFPLOCATION
  }

If l_line_counter >= L_MAX_LINES - 10 Then
  {
    L_PAGE_NUMBER = L_PAGE_NUMBER +1
    l_line_counter = 1
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                      "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                      "Page ",L_PAGE_NUMBER)
    --border
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
      }
     Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
  }
Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a2050h+0V",
                      "PART II -  BUSINESS   LIABILITY","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,"<033>&a750h+0V","LIMIT OF LIABILITY",
                      "<033>&a2500h+0V","COVERAGES","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h5v0P","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                      "$",L_LETTER_GOTHIC_BOLD_10,Str(L_LIABILITY,"ZZ,ZZZ,ZZZ"),
                      L_ARIAL_9,"<033>&a2200h+0V",
                      "Each Occurrence Limit - Coverage E and F","<NL>")
l_line_counter = l_line_counter +1

if sfpmastsupp:policy_no <> 0 then
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTSUPP:MEDICAL_LIMIT,"ZZ,ZZZ,ZZZ"),
                          L_ARIAL_9,"<033>&a2200h+0V",
                         "Medical Payments (Cov. F) - Limit Per Person","<NL>")
  end
else
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTER:MEDICAL_LIMIT,"ZZ,ZZZ,ZZZ"),
                          L_ARIAL_9,"<033>&a2200h+0V",
                         "Medical Payments (Cov. F) - Limit Per Person","<NL>")
  end
    l_line_counter = l_line_counter +1

if sfpmastsupp:policy_no <> 0 then
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTSUPP:GENERAL_AGGREGATE,"ZZ,ZZZ,ZZZ"),
                          L_ARIAL_9,"<033>&a2200h+0V","General Aggregate/Total ",
                          "Limits - All Other Than Products / Completed Operations",
                          "<NL>")
  end
else
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTER:GENERAL_AGGREGATE,"ZZ,ZZZ,ZZZ"),
                          L_ARIAL_9,"<033>&a2200h+0V","General Aggregate/Total ",
                          "Limits - All Other Than Products / Completed Operations",
                          "<NL>")
  end
l_line_counter = l_line_counter +1

If BOPOPERATIONS:EXCLUDE_PRODUCTS = "Y" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a750h+0V",
    "Not Applicable")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a700h+0V",
                      "$",L_LETTER_GOTHIC_BOLD_10,"<033>&a750h+0V",
                      Str(L_LIABILITY,"ZZ,ZZZ,ZZZ"))
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_9,"<033>&a2200h+0V",
                        "General Aggregate/Total Limits - Products / ",
                        "Completed Operations","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s","<033>&a150h-80V<033>*c5455h20v0P")
    -- the line under last general aggregate

If l_line_counter >= L_MAX_LINES - 4 Then
  {
    L_PAGE_NUMBER = L_PAGE_NUMBER +1
    l_line_counter = 1
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                      "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                      "Page ",L_PAGE_NUMBER)
    --border
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P")  --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<NL>",L_ARIAL_BOLD,"<033>&a700h+0V","THIS POLICY ",
                      "CONTAINS AGGREGATE LIMITS: REFER TO LIMITS OF ",
                      "INSURANCE SECTION","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a1700h+0V",
                      "PART II A OF THE COVERAGE FORM FOR DETAILS.","<NL>")
l_line_counter = l_line_counter +1

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_MORGAGE_ID = SFPSUPP:MORTGAGE_ID

Access SFSMORT,
   Set SFSMORT:COMPANY_ID  = SFPNAME:COMPANY_ID,
       SFSMORT:MORTGAGE_ID = L_MORGAGE_ID, Exact

If SFPSUPP:POLICY_NO = SFPPRINT1:POLICY_NO Then
  {
    If l_line_counter >= L_MAX_LINES - 15 Then
      {
        L_PAGE_NUMBER = L_PAGE_NUMBER +1
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                            "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                            "Page ",L_PAGE_NUMBER)
        l_line_counter = 1
        --border
        If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
          {
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
            Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
            Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
          }
        Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
        --line under the PART II
        l_line_counter = l_line_counter + 1
      }

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h+0V",
                        "6.","<033>&a2300h+0V","ADDITIONAL INTERESTS","<NL>")
    l_line_counter = l_line_counter +1

    Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a1550h+0V","We cover the following ",
                        "as their interest are indicated below:","<NL>")
    l_line_counter = l_line_counter + 1
  }


do print_mortgagee

/***********************************************************************************
 * if there are no additional interests then section 7. will be on the second page *
 * so I do not need to draw the line above 7. that is why I have the else there    *
 ***********************************************************************************/

If l_line_counter >= L_MAX_LINES - 20 Then
  {
    L_PAGE_NUMBER = L_PAGE_NUMBER +1
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                          "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                          "Page ",L_PAGE_NUMBER)
    l_line_counter = 1
    --border
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
    l_line_counter = l_line_counter +1
  }

Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h+20V","7.",
                      L_ARIAL_BOLD_12,"<033>&a1150h+0V","FORMS AND ENDORSEMENTS ",
                      "MADE PART OF THIS POLICY","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>",
                      "<033>&a+0h+20V")
l_line_counter = l_line_counter +1

L_SFPMASTER_FORM = l_sfsform
L_COMPANY_ID     = SFPNAME:COMPANY_ID

Access BOPGENERAL ,
   Set BOPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
       BOPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
       BOPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

-- This following code prints out the manditory endorsements, per line of business

Access SFPPRINT2,
   Set SFPPRINT2:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPPRINT2:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPPRINT2:END_SEQUENCE = SFPPRINT1:END_SEQUENCE , Generic

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
Writefile(L_FILE_NAME,"%s","Form Edition")
Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
Writefile(L_FILE_NAME,"%s","Description")
Writefile(L_FILE_NAME,"%s","<NL>")

While SFPPRINT2:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPPRINT2:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPPRINT2:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
  {
    if sfpprint2:lob_end_code one of "B", "" then
      begin
        If l_line_counter >= L_MAX_LINES - 6 Then
          {
            L_PAGE_NUMBER = L_PAGE_NUMBER +1
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                                  "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                                  "Page ",L_PAGE_NUMBER)
            l_line_counter = 1
            --border
            If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
              {
                Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
                Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
                Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
                Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
              }
            Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
            Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a1800h+0V",
                                  "FORMS AND ENDORSEMENTS CONTINUED","<NL>")
            l_line_counter = l_line_counter +1

            Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>",
                                           "<033>&a+0h+20V")
            l_line_counter = l_line_counter +1
          }

        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,"<033>&a350h+0V",
                              SFPPRINT2:FORM_EDITION,"<033>&a1750h+0V",
                              SFPPRINT2:DESCRIPTION,"<NL>")
        l_line_counter = l_line_counter +1

      end

    Next SFPPRINT2
  }

/*------------------------------------------------------------------------------
  The following code is for non-manditory endorsements
------------------------------------------------------------------------------*/

Access SFSMSOTERROR,
   Set SFSMSOTERROR:COMPANY_ID       = L_COMPANY_ID,
       SFSMSOTERROR:STATE            = I_STATE,
       SFSMSOTERROR:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS, Generic

While  SFSMSOTERROR:COMPANY_ID       = L_COMPANY_ID And
       SFSMSOTERROR:STATE            = I_STATE And
       SFSMSOTERROR:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS
  begin
    if SFSMSOTERROR:EFF_DATE <= SFPNAME:EFF_DATE then
       L_TERROR_FORM          = SFSMSOTERROR:TERRORISM_FORM_TO_ADD

    Next SFSMSOTERROR
   end

While SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
  {
    if sfpprint3:lob_end_code one of "X", "" then
      begin
        if sfpprint3:print_on_dec = 1 then
          {
            If l_line_counter >= L_MAX_LINES - 6 Then
              {
                L_PAGE_NUMBER = L_PAGE_NUMBER +1
                Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                                      "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                                      "Page ",L_PAGE_NUMBER)
                l_line_counter = 1
                --border
                If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
                  {
                    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
                    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
                    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
                    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
                  }
                Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
                Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a1800h+0V",
                                               "FORMS AND ENDORSEMENTS CONTINUED","<NL>")
                l_line_counter = l_line_counter +1

                Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>",
                                               "<033>&a+0h+20V")
                l_line_counter = l_line_counter +1
              }

            If SFPPRINT3:PRINT_FORM = "Y" Then
              {
                Writefile(L_FILE_NAME,"%s",L_ARIAL)
                Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
                Writefile(L_FILE_NAME,"%s",SFPPRINT3:FORM_EDITION)
                Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
                Writefile(L_FILE_NAME,"%s",Trun(SFPPRINT3:DESCRIPTION))

                If SFPPRINT3:CODE = L_TERROR_FORM Then
                  {
                    Writefile(L_FILE_NAME,"%s","<033>&a4500h+0V")
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                    Writefile(L_FILE_NAME,"%s","$")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                    if sfpmastsupp:policy_no <> 0 then
                      begin
                        Writefile(L_FILE_NAME,"%s",Str(SFPMASTSUPP:TERRORISM_PREMIUM,"ZZZ,ZZZ"))
                      end
                    else
                      begin
                        Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TERRORISM_PREMIUM,"ZZZ,ZZZ"))
                      end
                  }

                if sfpprint3:code = "BU2514" then
                  {
                    Writefile(L_FILE_NAME,"%s","<033>&a4500h+0V")
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                    Writefile(L_FILE_NAME,"%s","$")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)

                    Access BOPGENERAL, Set BOPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
                                           BOPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
                                           BOPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

                    l_total_boilers_premium = 0
                    while BOPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO and
                          BOPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR and
                          BOPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
                      {
                        l_total_boilers_premium = l_total_boilers_premium + bopgeneral:boilers_PREMIUM

                        next bopgeneral
                      }

                    if sfpname:line_of_business one of 99 then
                        Writefile(L_FILE_NAME,"%s",Str(sfpmastsupp:total[2],"ZZZ,ZZZ"))
                    else
                        Writefile(L_FILE_NAME,"%s",Str(sfpmaster:total[2],"ZZZ,ZZZ"))
                  }

                Writefile(L_FILE_NAME,"%s","<NL>")
                l_line_counter = l_line_counter + 1
              }

          }
      end
      Next SFPPRINT3
  }

--reaccess file in order to get first locations state to be printed in front of mandatory Forms
Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","*    ")
Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
Writefile(L_FILE_NAME,"%s",SFPLOCATION:STR_STATE)
Writefile(L_FILE_NAME,"%s"," Mandatory Forms")
Writefile(L_FILE_NAME,"%s","<NL>")
l_line_counter = l_line_counter +1

Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>","<NL>")
l_line_counter = l_line_counter +2

If l_line_counter >= L_MAX_LINES - 12 Then
  {
    L_PAGE_NUMBER = L_PAGE_NUMBER +1
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                          "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                          "Page ",L_PAGE_NUMBER)
    l_line_counter = 1
    --border
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s%s","<033>&a+0h300V","<NL>") --sets starting point for newpage
  }
if sfpmastsupp:policy_no <> 0 then
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTSUPP:TOTAL[1] + SFPMASTSUPP:TOTAL[2] + SFPMASTSUPP:TERRORISM_PREMIUM,"ZZZ,ZZZ,ZZZ"),
                          L_ARIAL,"<033>&a1900h+0V","< Annual Premium","<NL>")
  end
else
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V","$",
                          L_LETTER_GOTHIC_BOLD_10,
                          Str(SFPMASTER:TOTAL[1] + SFPMASTER:TOTAL[2] + SFPMASTER:TERRORISM_PREMIUM,"ZZZ,ZZZ,ZZZ"),
                          L_ARIAL,"<033>&a1900h+0V","< Annual Premium","<NL>")
  end
l_line_counter = l_line_counter +1

If Trun(SCIPSCONTROL:SURCHARGE_WORDING) <> "" Then
  {
    if sfpmastsupp:policy_no <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V",
                              "$",L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:SURCHARGE,"ZZZ,ZZZ,ZZZ"),
                              L_ARIAL,"<033>&a1900h+0V","< ",
                              Trun(SCIPSCONTROL:SURCHARGE_WORDING),"<NL>")
      end
    else
      begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V",
                              "$",L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:SURCHARGE,"ZZZ,ZZZ,ZZZ"),
                              L_ARIAL,"<033>&a1900h+0V","< ",
                              Trun(SCIPSCONTROL:SURCHARGE_WORDING),"<NL>")
      end
    l_line_counter = l_line_counter +1
  }

if sfpmastsupp:policy_no <> 0 then
  begin
    If SFPMASTSUPP:SURCHARGE > 0 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V","$",
                               L_LETTER_GOTHIC_BOLD_10,
                               Str(SFPMASTSUPP:TOTAL[1] + SFPMASTSUPP:TOTAL[2] +
                               SFPMASTSUPP:SURCHARGE + sfpmastsupp:terrorism_premium,"ZZZ,ZZZ,ZZZ"))
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL,"<033>&a1900h+0V",L_ARIAL_BOLD,
                              "< Total Premium","<NL>")
        l_line_counter = l_line_counter + 1
      }
  end
else
  begin
    If SFPMASTER:SURCHARGE > 0 Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a750h+0V","$",
                               L_LETTER_GOTHIC_BOLD_10,
                               Str(SFPMASTER:TOTAL[1] + SFPMASTER:TOTAL[2] +
                               SFPMASTER:SURCHARGE + sfpmaster:terrorism_premium,"ZZZ,ZZZ,ZZZ"))
        Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL,"<033>&a1900h+0V",L_ARIAL_BOLD,
                              "< Total Premium","<NL>")
        l_line_counter = l_line_counter + 1
      }
  end

if sfpmastsupp:policy_no <> 0 then
  begin
    if scipscontrol:breakout_pliga = 1 then
      begin
        If L_TRANS_CODE One Of 11, 16 Then  --these are endorsements transcodes
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION_1)
          end
        else
        If L_TRANS_CODE One Of 12,13 Then  --these are endorsements transcodes
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:endorsement_DEFINITION)
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:endorsement_DEFINITION_1)
          end
      end
    else
      begin
        If L_TRANS_CODE One Of 11, 12, 13, 16 Then
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTSUPP:AMT_DUE_TOTAL[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
          end
      end
  end
else
  begin
    if scipscontrol:breakout_pliga = 1 then
      begin
        If L_TRANS_CODE One Of 11, 16 Then  --these are endorsements transcodes
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION_1)
          end
        else
        If L_TRANS_CODE One Of 12,13 Then  --these are endorsements transcodes
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:endorsement_DEFINITION)
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:endorsement_DEFINITION_1)
          end
      end
    else
      begin
        If L_TRANS_CODE One Of 11, 12, 13, 16 Then
          begin
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL_BOLD,"<033>&a750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_10,
                              Str(SFPMASTER:AMT_DUE_TOTAL[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a1900h+0V",L_ARIAL_BOLD,"< ",
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
          end
      end
  end

Writefile(L_FILE_NAME,"%s%s%s","<nl>","<NL>","<NL>")
If (SCIPSCONTROL:COUNTERSIGNATURE_DATE = 1) Then
  {
    Writefile(L_FILE_NAME,"%s%d%s","<033>&a800h-20V",TODAYSDATE,
                          "<033>&a+0h+20V")
  }

If (SCIPSCONTROL:SIGNATURE = 1) Then
  {
    --the next line of code will be used to a signature
    L_SIGNATURE_STRING = "<033>" + Trun(SCIPSCONTROL:SIGNATURE_SYMBOL_SET) +
                         "<033>" + Trun(SCIPSCONTROL:SIGNATURE_DEFINITION)

    Writefile(L_FILE_NAME,"%s","<033>&a")
    Writefile(L_FILE_NAME,"%n",SCIPSCONTROL:SIGNATURE_HOZ_POS)
    Writefile(L_FILE_NAME,"%s","h-20V")
    Writefile(L_FILE_NAME,"%s",trun(L_SIGNATURE_STRING))
    Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_STRING_TO_PRINT))
    Writefile(L_FILE_NAME,"%s","<033>&a+0h+20V")
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,"<033>&a200h+0V<033>*c2000h5v0P",
                      "<033>&a2575h+0V","By:","<033>&a2750h-0V<033>*c2800h5v0P","<NL>")
l_line_counter = l_line_counter + 1

Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a800h+0V","Countersignature Date",
                      "<033>&a3200h+0V","Representative")
l_line_counter = l_line_counter + 1

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

If L_PAGE_NUMBER Mod 2 > 0 Then
  {
    Writefile(L_FILE_NAME,"%s","<FF>")
  }

Screen Exit
Writefile(L_FILE_NAME,"%s%s%s","<033>&l",trun(SCIPSCONTROL:PAPER_TRAY[3]),"H")
Writefile(L_FILE_NAME,"%s%s",L_FORMFEED ,L_RESET)
Closefile(L_FILE_NAME)

procedure definition

procedure print_mortgagee
BEGIN
  While SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
    begin
      if sfsline_alias:lob_code one of "CPORTFOLIO" THEN
        begin
          if sfpsupp:print_on_which_dec[1] = 1 then
            begin
              do addition_interest_header
              If (SFPSUPP:MORTGAGE_ID <> "") Then
                begin
                  do sfsmort_print
                end
              Else
                begin
                do sfpsupp_print
                end
            end
        end
      else
        begin
          do addition_interest_header
          If (SFPSUPP:MORTGAGE_ID <> "") Then
            {
              do sfsmort_print
            }
          Else
            {
              do sfpsupp_print
            }
        end
      l_line_counter = l_line_counter +1
      Next SFPSUPP
    }
END

procedure addition_interest_header

BEGIN
  L_MORGAGE_ID = SFPSUPP:MORTGAGE_ID
  Access SFSMORT,
     Set SFSMORT:COMPANY_ID  = SFPNAME:COMPANY_ID,
         SFSMORT:MORTGAGE_ID = L_MORGAGE_ID, Exact

  If (Val(SFPSUPP:STR_ZIPCODE[6,9]) = 0) Then
    {
      L_SFPSUPP_ZIP = SFPSUPP:STR_ZIPCODE[1,5]
    }
  Else
    {
      L_SFPSUPP_ZIP = SFPSUPP:STR_ZIPCODE[1,5] + "-" +
                      SFPSUPP:STR_ZIPCODE[6,9]
    }

  If (Val(SFSMORT:STR_ZIPCODE[6,9]) = 0) Then
    {
      L_SFSMORT_ZIP = SFSMORT:STR_ZIPCODE[1,5]
    }
  Else
    {
      L_SFSMORT_ZIP = SFSMORT:STR_ZIPCODE[1,5] + "-" + SFSMORT:STR_ZIPCODE[6,9]
    }

  If l_line_counter >= L_MAX_LINES - 12 Then
    {
      L_PAGE_NUMBER = L_PAGE_NUMBER +1

      Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                            "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7250V",
                            "Page ",L_PAGE_NUMBER)
      l_line_counter = 1
      --border
      If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
        {
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
          Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
          Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
        }
      Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
      Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a2000h+0V",
                      "ADDITIONAL INTERESTS CONTINUED","<NL>")
      l_line_counter = l_line_counter + 1
    }
  Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
END

Procedure sfpsupp_print

BEGIN
  If (SFPSUPP:POLICY_NO = SFPPRINT1:POLICY_NO) Then
    {
      Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s",L_ARIAL_BOLD,
                        "<033>&a350h+0V","Location",
                        "<033>&a900h+0V",SFPSUPP:PREM_NO,"<033>&a1350h+0V",
                        "Building","<033>&a1800h+0V",SFPSUPP:BUILD_NO,"<NL>")
      l_line_counter = l_line_counter +1

      Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V","Interest ",L_ARIAL)
      L_COMPANY_ID      = SFPNAME:COMPANY_ID
      L_MORTGAGE_TYPE_2 = SFPSUPP:MORTGAGE_TYPE_2
      Access SFSMORTTYPE,
         Set SFSMORTTYPE:COMPANY_ID    = L_COMPANY_ID,
             SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact

      --access the sfspayotype to print out description firt mortgage or loss payee ...etc
      Writefile(L_FILE_NAME,"%s%s","<033>&a900h+0V",SFSMORTTYPE:DESCRIPTION)
      Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD,"<033>&a350h+0V",
                            "Name",L_ARIAL)
      for l_loop = 1 to 3
        {
          If (SFPSUPP:NAME[l_loop] <> "" ) Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:NAME[l_loop],"<NL>")
              l_line_counter = l_line_counter +1
            }
        }
      If (SFPSUPP:SUCCESSOR = "Y") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                Uppercase("It's Successors and/or Assigns"),"<NL>")
          l_line_counter = l_line_counter +1
        }
      If (SFPSUPP:ATIMA = "Y") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
          l_line_counter = l_line_counter +1
        }
      If (SFPSUPP:ACCOUNT_NO <> "") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                     "Loan # ",L_ARIAL,"<033>&a900h+0V",
                     SFPSUPP:ACCOUNT_NO,"<NL>")
          l_line_counter = l_line_counter +1
        }
      Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                            "Address ",L_ARIAL)
      for l_loop = 1 to 3
        {
          If (SFPSUPP:ADDRESS[l_loop] <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:ADDRESS[l_loop],
                               "<NL>")
              l_line_counter = l_line_counter +1
            }
        }
      Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h+0V",Trun(SFPSUPP:CITY),", ",
                        SFPSUPP:STR_STATE," ",L_SFPSUPP_ZIP,"<NL>")
      l_line_counter = l_line_counter +1
    }
END

procedure sfsmort_print

BEGIN
  Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                                "Location","<033>&a900h+0V",SFPSUPP:PREM_NO,
                                "<033>&a1350h+0V","Building","<033>&a1800h+0V",
                                SFPSUPP:BUILD_NO,"<NL>")
  l_line_counter = l_line_counter +1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V","Interest ",L_ARIAL)
   --accesses the paytype file to print the description on the dec page
  L_COMPANY_ID      = SFPNAME:COMPANY_ID
  L_MORTGAGE_TYPE_2 = SFPSUPP:MORTGAGE_TYPE_2

  Access SFSMORTTYPE,
     Set SFSMORTTYPE:COMPANY_ID    = L_COMPANY_ID,
         SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact
  --access the sfsmorttype to print out firt mortgage or loss payee ...etc
  Writefile(L_FILE_NAME,"%s%s","<033>&a900h+0V",SFSMORTTYPE:DESCRIPTION)

  Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD,"<033>&a350h-0V",
                        "Name",L_ARIAL)
  for l_loop = 1 to 3
    {
      If (SFSMORT:NAME[l_loop] <> "" ) Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFSMORT:NAME[l_loop],"<NL>")
          l_line_counter = l_line_counter +1
        }
    }
  If (SFSMORT:SUCCESSOR = "Y") Then
    {
      Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
               Uppercase("It's Successors and/or Assigns"),"<NL>")
      l_line_counter = l_line_counter +1
    }
  If (SFSMORT:ATIMA = "Y") Then
    {
      Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
      l_line_counter = l_line_counter +1
    }
  If (SFPSUPP:ACCOUNT_NO <> "") Then
    {
      Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                            "Loan # ",L_ARIAL,"<033>&a900h+0V",
                            SFPSUPP:ACCOUNT_NO,"<NL>")
      l_line_counter = l_line_counter +1
    }
  Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V","Address ",
                        L_ARIAL)
  for l_loop = 1 to 3
    {
      If (SFSMORT:ADDRESS[l_loop] <> "") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h-0V",SFSMORT:ADDRESS[l_loop],
                                "<NL>")
          l_line_counter = l_line_counter +1
        }
    }
  Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h+0V",Trun(SFSMORT:CITY),", ",
                       SFSMORT:STR_STATE,"  ",L_SFSMORT_ZIP,"<NL>")
  l_line_counter = l_line_counter +1
END

procedure check_payor_flags

BEGIN
  if scipscontrol:payor_code_bottom_of_page one of 1 and
     sfpname:eff_date >= scipscontrol:payor_code_bottom_page_date then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a4000h+0V")
      If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
        {
          If SCIPSCONTROL:payor_code_bottom_of_page one of 1 and
             trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
            {
              do print_payor_codes
            }
        }
      else
        {
          If SCIPSCONTROL:payor_code_bottom_of_page one of 1 then
            {
              do print_payor_codes
            }
        }
    }
END

Procedure print_payor_codes

BEGIN
  L_BILL_PLAN = SFPNAME:BILL_PLAN
  If SFPSUPP:MORTGAGE_TYPE_1 = "" Then
    {
      L_MORTGAGE_TYPE_1 = " "
    }
  Else
    {
      L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
    }
  Access SFSPAYCODE,
     Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
         SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
         SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic
  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a+0h+0V")
  Writefile(L_FILE_NAME,"%s"," - ")
  Writefile(L_FILE_NAME,"%s",SFPNAME:BILL_PLAN)
  Writefile(L_FILE_NAME,"%s"," - ")
  Writefile(L_FILE_NAME,"%s",SFSPAYCODE:PAY_CODE)
END

End--end of program
